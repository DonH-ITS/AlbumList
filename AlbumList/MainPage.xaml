<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="AlbumList.MainPage"
             Title="Music Library"
             xmlns:local="clr-namespace:AlbumList"
             x:DataType="local:AlbumViewModel">

    <ScrollView>
        <VerticalStackLayout Padding="20">
            <!-- Editable library name -->
            <Label Text="Library Name:" FontAttributes="Bold"/>
            <Entry Text="{Binding LibraryName}" Placeholder="Enter library name"/>
            <Label Text="{Binding LibraryName}" FontSize="Medium" FontAttributes="Bold" HorizontalOptions="Center"/>
            <!-- Sort Options -->
            <Label Text="Options:" FontAttributes="Bold" Margin="0,10,0,5"/>
            <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                <Button Text="Add Album" Clicked="AddAlbumButton_Clicked"/>
                <Button x:Name="SaveButton" Text="Save Library" Clicked="SaveButton_Clicked"/>
            </HorizontalStackLayout>
            <Label HeightRequest="5"/>
            <HorizontalStackLayout Spacing="10" HorizontalOptions="Center">
                <Button Text="Title" Clicked="SortByClicked"/>
                <Button Text="Artist" Clicked="SortByClicked"/>
                <Button Text="Year" Clicked="SortByClicked"/>
            </HorizontalStackLayout>

            <ActivityIndicator IsVisible="{Binding ShowActivity}" IsRunning="{Binding ShowActivity}"/>
            <CollectionView ItemsSource="{Binding Albums}" 
                        SelectionMode="Single"
                        SelectedItem="{Binding SelectedAlbum}"
                       SelectionChanged="CollectionView_SelectionChanged" >
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="local:Album">
                        <Grid Padding="10" VerticalOptions="Center" ColumnDefinitions="*,55">
                            <VerticalStackLayout Padding="10">
                                <Label Text="{Binding Title}" FontSize="Medium" FontAttributes="Bold"/>
                                <Label Text="{Binding Artist}" FontSize="Small"/>
                                <Label Text="{Binding Year}" FontSize="Small"/>
                                <Label Text="{Binding Genre}" FontSize="Small"/>
                            </VerticalStackLayout>
                            <Button Text="Edit" Grid.Column="1"
                                    HorizontalOptions="End"
                                    VerticalOptions="Center"
                                    Margin="20,0,0,0"
                                    Clicked="EditButton_Clicked"
                                    WidthRequest="55"
                                    HeightRequest="50"
                                    CommandParameter="{Binding .}" />
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
